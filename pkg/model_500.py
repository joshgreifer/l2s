import logging

import torch
from torch_geometric.data import Data
from torch_geometric.nn import GCNConv, global_mean_pool
import torch.nn.functional as F

from pkg.face_mesh import FACEMESH_TESSELATION
from pkg.gaze_model import GazeModel


class GazeGCN(GazeModel):


    def __init__(self, config, *, logger=None, filename=None):
        super().__init__(config, logger, filename=filename)

        assert(config.version == 500), "GazeGCN is only compatible with config version 500"
        self.logger = logger or logging.getLogger(__name__)

        in_channels = 3  # Default to 3 channels (x, y, z)
        hidden_channels = config.hidden_channels or 16
        out_channels = 2  # Output is 2D gaze coordinates

        edge_index = torch.tensor(list(FACEMESH_TESSELATION), dtype=torch.long).t().contiguous()
        self.register_buffer('edge_index', edge_index, persistent=False)

        self.conv1 = GCNConv(in_channels, hidden_channels)
        self.conv2 = GCNConv(hidden_channels, hidden_channels)
        # self.conv3 = GCNConv(hidden_channels, hidden_channels)
        self.pool = global_mean_pool  # You could also try global_max_pool
        self.fc1 = torch.nn.Linear(hidden_channels, hidden_channels)
        self.fc2 = torch.nn.Linear(hidden_channels, out_channels)


        if filename is not None:
            self.load(filename)

    def forward(self, x: torch.Tensor) -> torch.Tensor:
        # x: [batch_size, num_nodes, in_channels]
        batch_size, num_nodes, in_channels = x.shape

        # Flatten nodes across all meshes
        x = x.view(-1, in_channels)  # [batch_size * num_nodes, in_channels]

        # Create the batch vector
        batch = torch.arange(batch_size, device=x.device).repeat_interleave(num_nodes)
        # batch: [batch_size * num_nodes] assigns each node to the correct graph

        x = F.relu(self.conv1(x, self.edge_index))
        x = F.relu(self.conv2(x, self.edge_index))
        # x = F.relu(self.conv3(x, self.edge_index))

        x = self.pool(x, batch)  # [batch_size, hidden_channels]

        x = F.relu(self.fc1(x))
        x = torch.tanh(self.fc2(x))  # [batch_size, 2]
        return x


if __name__ == "__main__":
    # edges = list(FACEMESH_TESSELATION)
    # edge_index = torch.tensor(edges, dtype=torch.long).t().contiguous()

    landmarks = [[0.5951729416847229, 0.683172881603241, -0.02313901111483574],
                 [0.6000847816467285, 0.6332322955131531, -0.0515185184776783],
                 [0.5989816188812256, 0.6431497931480408, -0.02479458972811699],
                 [0.5947632789611816, 0.5813387632369995, -0.041845761239528656],
                 [0.6010400652885437, 0.6193873286247253, -0.05574220046401024],
                 [0.602246105670929, 0.5988712906837463, -0.053187135607004166],
                 [0.6052350401878357, 0.5449251532554626, -0.03076510690152645],
                 [0.5352498888969421, 0.5240563154220581, 0.007306712679564953],
                 [0.6069273352622986, 0.5067368745803833, -0.026906432583928108],
                 [0.6079053282737732, 0.48800796270370483, -0.03060867451131344],
                 [0.6110391616821289, 0.41222885251045227, -0.025381213054060936],
                 [0.594905436038971, 0.6870494484901428, -0.021274853497743607],
                 [0.5948182344436646, 0.6898311972618103, -0.017468323931097984],
                 [0.5943538546562195, 0.6920081973075867, -0.012899184599518776],
                 [0.5942308902740479, 0.6922723650932312, -0.009822673164308071],
                 [0.593764066696167, 0.6975207328796387, -0.011152351275086403],
                 [0.5934284925460815, 0.7039021253585815, -0.012566763907670975],
                 [0.5927157402038574, 0.7096788287162781, -0.01057224627584219],
                 [0.592771589756012, 0.7225308418273926, -0.000362158112693578],
                 [0.5996835827827454, 0.6390472054481506, -0.04591301456093788],
                 [0.5896400213241577, 0.6358608603477478, -0.03214693069458008],
                 [0.5008106827735901, 0.4532337486743927, 0.04771198704838753],
                 [0.5654699802398682, 0.5399092435836792, -0.0018853406654670835],
                 [0.5547339916229248, 0.5406869649887085, -0.0012864964082837105],
                 [0.544245183467865, 0.5394007563591003, 0.0011781341163441539],
                 [0.531649649143219, 0.5276638269424438, 0.008955774828791618],
                 [0.5742532014846802, 0.5370768904685974, -0.0010404407512396574],
                 [0.5491222739219666, 0.4975539743900299, -0.007358856964856386],
                 [0.5610924363136292, 0.5001388192176819, -0.007489217445254326],
                 [0.5386404991149902, 0.4992006719112396, -0.004311677534133196],
                 [0.5321407914161682, 0.5038488507270813, -0.0001947261771420017],
                 [0.5236649513244629, 0.5356204509735107, 0.01424841582775116],
                 [0.5568163990974426, 0.735155463218689, 0.013107760809361935],
                 [0.5316570401191711, 0.5184497237205505, 0.01005732174962759],
                 [0.49527546763420105, 0.5152449011802673, 0.056837230920791626],
                 [0.5125628113746643, 0.5219722986221313, 0.023152045905590057],
                 [0.5527952909469604, 0.603697657585144, -0.006358339451253414],
                 [0.5847055912017822, 0.6785383820533752, -0.022043980658054352],
                 [0.5853404402732849, 0.6875519752502441, -0.016112573444843292],
                 [0.5750367641448975, 0.6790281534194946, -0.016112573444843292],
                 [0.5679450631141663, 0.6801131963729858, -0.008890594355762005],
                 [0.5772974491119385, 0.6857279539108276, -0.012475511990487576],
                 [0.5705662965774536, 0.6846232414245605, -0.005996589083224535],
                 [0.5514588356018066, 0.6928913593292236, 0.008277899585664272],
                 [0.5919188261032104, 0.6316724419593811, -0.05073635280132294],
                 [0.5916935205459595, 0.6182411909103394, -0.05459502711892128],
                 [0.5192731618881226, 0.4899842441082001, 0.00043019006261602044],
                 [0.5748983025550842, 0.5687103867530823, -0.010735196992754936],
                 [0.5709102749824524, 0.6204397082328796, -0.02633284404873848],
                 [0.5709832906723022, 0.6117921471595764, -0.02382992021739483],
                 [0.5245135426521301, 0.5961804986000061, 0.005198129918426275],
                 [0.5932385921478271, 0.5988836884498596, -0.050058480352163315],
                 [0.5422529578208923, 0.48023632168769836, -0.017455287277698517],
                 [0.528598427772522, 0.48233163356781006, -0.00979660078883171],
                 [0.5112504959106445, 0.4332217574119568, 0.026398025453090668],
                 [0.5854901075363159, 0.5001986622810364, -0.02422100119292736],
                 [0.5712839365005493, 0.5072526931762695, -0.004165021702647209],
                 [0.5452567934989929, 0.679564893245697, 0.009620614349842072],
                 [0.4998689293861389, 0.6452370882034302, 0.09474610537290573],
                 [0.5772485733032227, 0.6287564635276794, -0.022043980658054352],
                 [0.5840893983840942, 0.6343424916267395, -0.022604532539844513],
                 [0.5570849180221558, 0.6826907992362976, 0.008043250069022179],
                 [0.55947345495224, 0.6829836964607239, 0.005227460991591215],
                 [0.5240745544433594, 0.47200340032577515, -0.005859710276126862],
                 [0.5704816579818726, 0.6251342296600342, -0.02040143683552742],
                 [0.5606797337532043, 0.4848695397377014, -0.022487208247184753],
                 [0.5592631101608276, 0.47352612018585205, -0.025459429249167442],
                 [0.5522312521934509, 0.4115096926689148, -0.01304909959435463],
                 [0.5177544355392456, 0.45279836654663086, 0.007717348635196686],
                 [0.5567474365234375, 0.4431990385055542, -0.02023196779191494],
                 [0.5137096643447876, 0.4810642898082733, 0.008414777927100658],
                 [0.5069500803947449, 0.46822798252105713, 0.026697855442762375],
                 [0.5848809480667114, 0.6835862398147583, -0.020297149196267128],
                 [0.5762423276901245, 0.682806134223938, -0.0147568229585886],
                 [0.5692652463912964, 0.68222975730896, -0.008251827210187912],
                 [0.5792574882507324, 0.6315160393714905, -0.019906066358089447],
                 [0.5583311319351196, 0.6828436255455017, 0.006449592299759388],
                 [0.5624635219573975, 0.6867012977600098, 0.0010819932213053107],
                 [0.5609082579612732, 0.6834388971328735, 0.004911336582154036],
                 [0.5817630887031555, 0.6270761489868164, -0.03629239648580551],
                 [0.5716131329536438, 0.6861478686332703, -0.004399671219289303],
                 [0.5783252120018005, 0.687529444694519, -0.008519066497683525],
                 [0.5859145522117615, 0.6898562908172607, -0.011882370337843895],
                 [0.5803477764129639, 0.7204487919807434, -0.00019798519497271627],
                 [0.5820956230163574, 0.7072595357894897, -0.010233309119939804],
                 [0.5828465819358826, 0.7009290456771851, -0.01196710579097271],
                 [0.5840785503387451, 0.6952160000801086, -0.010233309119939804],
                 [0.5856877565383911, 0.6901077628135681, -0.008897112682461739],
                 [0.5715093016624451, 0.6861351132392883, -0.0025778813287615776],
                 [0.5692794322967529, 0.6880956292152405, -0.004057474434375763],
                 [0.5672847628593445, 0.69120192527771, -0.004947185516357422],
                 [0.5656015872955322, 0.6943464279174805, -0.003009700682014227],
                 [0.5583399534225464, 0.659946858882904, -0.0070459917187690735],
                 [0.49326232075691223, 0.5709861516952515, 0.10282845795154572],
                 [0.5993421673774719, 0.6409600377082825, -0.032225146889686584],
                 [0.5664779543876648, 0.6846804022789001, 0.0016213601920753717],
                 [0.5645131468772888, 0.6858356595039368, 0.0008302341448143125],
                 [0.5869075655937195, 0.6405521631240845, -0.02233077399432659],
                 [0.5729774832725525, 0.6329798698425293, -0.012586317956447601],
                 [0.5855217576026917, 0.6378690600395203, -0.02278703637421131],
                 [0.5645918846130371, 0.575404942035675, -0.006707054562866688],
                 [0.547722578048706, 0.5831097364425659, -0.00350344181060791],
                 [0.569166362285614, 0.6168749332427979, -0.017794225364923477],
                 [0.5275254249572754, 0.4189516305923462, 0.004872228484600782],
                 [0.5336520671844482, 0.44399702548980713, -0.007332785055041313],
                 [0.5392881035804749, 0.46856340765953064, -0.01668616011738777],
                 [0.5590134859085083, 0.7033119797706604, 0.004494182299822569],
                 [0.5827856063842773, 0.48171624541282654, -0.029722221195697784],
                 [0.5812369585037231, 0.4464814066886902, -0.027141081169247627],
                 [0.5790569186210632, 0.40977293252944946, -0.023269370198249817],
                 [0.5360625386238098, 0.5350464582443237, 0.005168798845261335],
                 [0.5132630467414856, 0.5436995029449463, 0.020375365391373634],
                 [0.5797227025032043, 0.5336986184120178, 0.00019085609528701752],
                 [0.522979199886322, 0.5076121091842651, 0.007730384822934866],
                 [0.5818158388137817, 0.5610417723655701, -0.014939327724277973],
                 [0.5764358639717102, 0.6177663803100586, -0.03652704507112503],
                 [0.5023431181907654, 0.5501791834831238, 0.03196442499756813],
                 [0.5194651484489441, 0.5570259690284729, 0.012351669371128082],
                 [0.5316381454467773, 0.5657790303230286, 0.0037609038408845663],
                 [0.5508050918579102, 0.5657558441162109, -0.0006318416562862694],
                 [0.5651699304580688, 0.5609552264213562, -0.002933114068582654],
                 [0.575352132320404, 0.5560605525970459, -0.006123690400272608],
                 [0.5956783890724182, 0.5468249320983887, -0.026880363002419472],
                 [0.5032150149345398, 0.581561267375946, 0.031547270715236664],
                 [0.5150794982910156, 0.5037113428115845, 0.011849780566990376],
                 [0.5945292711257935, 0.637856662273407, -0.04539156332612038],
                 [0.57520592212677, 0.5855026841163635, -0.013335891999304295],
                 [0.4926948845386505, 0.5071096420288086, 0.08963596820831299],
                 [0.5834012627601624, 0.5502061247825623, -0.0080953948199749],
                 [0.568289041519165, 0.6159296035766602, -0.007691276725381613],
                 [0.5282490849494934, 0.5177525877952576, 0.011843263171613216],
                 [0.576954185962677, 0.6072187423706055, -0.033424463123083115],
                 [0.49526870250701904, 0.6064167022705078, 0.10121197998523712],
                 [0.5792357921600342, 0.5286125540733337, 0.0023139009717851877],
                 [0.5846822261810303, 0.601464569568634, -0.04369688034057617],
                 [0.5172132849693298, 0.6928805112838745, 0.04565228894352913],
                 [0.516864538192749, 0.7040074467658997, 0.06450243294239044],
                 [0.4942726194858551, 0.576834499835968, 0.06710965186357498],
                 [0.5072990655899048, 0.6696045994758606, 0.05610721558332443],
                 [0.5005980730056763, 0.4889507293701172, 0.04432260990142822],
                 [0.5537567138671875, 0.7476254105567932, 0.020297149196267128],
                 [0.5953111052513123, 0.6401864886283875, -0.0315733440220356],
                 [0.5657947063446045, 0.5944012999534607, -0.008871040306985378],
                 [0.5045472383499146, 0.5212686061859131, 0.033137671649456024],
                 [0.5456109046936035, 0.531749427318573, 0.0019048945978283882],
                 [0.554928719997406, 0.5333109498023987, -0.0003937298315577209],
                 [0.5607529878616333, 0.688725471496582, 0.002926595974713564],
                 [0.5041836500167847, 0.6100231409072876, 0.03743956983089447],
                 [0.5700655579566956, 0.7677761316299438, 0.02479458972811699],
                 [0.54197758436203, 0.7422715425491333, 0.04168932884931564],
                 [0.5301783680915833, 0.7265832424163818, 0.05157065764069557],
                 [0.6094889640808105, 0.4498761296272278, -0.029018275439739227],
                 [0.5904750227928162, 0.7725127935409546, 0.022422026842832565],
                 [0.5639088153839111, 0.5321782231330872, -0.0009263751562684774],
                 [0.5723231434822083, 0.530138373374939, 0.0003474925470072776],
                 [0.5775073170661926, 0.5293779373168945, 0.0021395436488091946],
                 [0.508371114730835, 0.49772271513938904, 0.021731115877628326],
                 [0.5695576667785645, 0.5170937180519104, -0.0017940880497917533],
                 [0.5600919127464294, 0.5116047263145447, -0.0036729106213897467],
                 [0.5507835745811462, 0.5099047422409058, -0.003286717226728797],
                 [0.5419073104858398, 0.5110502243041992, -0.0008783047669567168],
                 [0.5366837382316589, 0.5139001607894897, 0.0024491501972079277],
                 [0.49501365423202515, 0.47653770446777344, 0.070655457675457],
                 [0.5393632650375366, 0.5281908512115479, 0.004790752660483122],
                 [0.5977256298065186, 0.6552823781967163, -0.022043980658054352],
                 [0.5679372549057007, 0.6544219255447388, -0.012547209858894348],
                 [0.5773440599441528, 0.6273719668388367, -0.026111232116818428],
                 [0.5850368142127991, 0.6540056467056274, -0.02126181684434414],
                 [0.6061391234397888, 0.5242325067520142, -0.02501620538532734],
                 [0.5287342667579651, 0.7141194939613342, 0.03796101361513138],
                 [0.5405991077423096, 0.7303743362426758, 0.029826510697603226],
                 [0.570146918296814, 0.7605257630348206, 0.011804154142737389],
                 [0.5073299407958984, 0.678264856338501, 0.0806671530008316],
                 [0.5761896371841431, 0.5241899490356445, 0.0004786678764503449],
                 [0.5878795385360718, 0.5703022480010986, -0.028053607791662216],
                 [0.5908488035202026, 0.7655775547027588, 0.009953033179044724],
                 [0.5548069477081299, 0.7566899657249451, 0.03146905452013016],
                 [0.4962773323059082, 0.6084951162338257, 0.06846539676189423],
                 [0.5779754519462585, 0.6880450248718262, -0.006048732902854681],
                 [0.5758577585220337, 0.6914154887199402, -0.007730384822934866],
                 [0.5741637945175171, 0.6962341070175171, -0.008871040306985378],
                 [0.5726393461227417, 0.701632022857666, -0.007221979089081287],
                 [0.5683907866477966, 0.7131184339523315, 0.0007340933079831302],
                 [0.5649775266647339, 0.6836586594581604, -0.0003739720559678972],
                 [0.5633732080459595, 0.6826242208480835, -0.00048763019731268287],
                 [0.5620995759963989, 0.6813510656356812, -0.0006762457196600735],
                 [0.550713300704956, 0.6687850952148438, 0.0006562842754647136],
                 [0.5163434147834778, 0.6235216856002808, 0.018159234896302223],
                 [0.5887525081634521, 0.5530962944030762, -0.020310185849666595],
                 [0.5861724615097046, 0.5206670165061951, -0.005501218140125275],
                 [0.5802434682846069, 0.5200795531272888, -0.0016531356377527118],
                 [0.5663549900054932, 0.6849445700645447, 0.0007190203759819269],
                 [0.5126268267631531, 0.654620349407196, 0.03595345839858055],
                 [0.5939026474952698, 0.5239885449409485, -0.01812012679874897],
                 [0.5623302459716797, 0.7235449552536011, 0.007528326474130154],
                 [0.6033088564872742, 0.5804319977760315, -0.04531335458159447],
                 [0.5950692296028137, 0.5647613406181335, -0.03548416122794151],
                 [0.604068398475647, 0.5633517503738403, -0.037804581224918365],
                 [0.5803552865982056, 0.5928359627723694, -0.02581140398979187],
                 [0.5913122296333313, 0.7527892589569092, 0.0032199074048548937],
                 [0.5922126173973083, 0.736703634262085, 0.0019961469806730747],
                 [0.5768535733222961, 0.7331447005271912, 0.00356862205080688],
                 [0.541533350944519, 0.6955835819244385, 0.014835040085017681],
                 [0.5589625835418701, 0.6251178979873657, -0.005103618372231722],
                 [0.5507171750068665, 0.7112303972244263, 0.011654241010546684],
                 [0.5369023084640503, 0.6185032725334167, -0.001388340606354177],
                 [0.5492648482322693, 0.6381700038909912, -0.0028092714492231607],
                 [0.5277272462844849, 0.6391590237617493, 0.00832352600991726],
                 [0.5725643634796143, 0.7482563257217407, 0.005491441115736961],
                 [0.5748081207275391, 0.5988575220108032, -0.01800280250608921],
                 [0.5322558879852295, 0.7025439143180847, 0.025224780663847923],
                 [0.5444788336753845, 0.7196804285049438, 0.020779483020305634],
                 [0.5347679257392883, 0.6782786846160889, 0.014456992968916893],
                 [0.5053637027740479, 0.633903443813324, 0.04309722036123276],
                 [0.5226282477378845, 0.6751145124435425, 0.024247076362371445],
                 [0.49976998567581177, 0.639081597328186, 0.0669010728597641],
                 [0.5408573746681213, 0.6552897691726685, 0.003164504189044237],
                 [0.5816137790679932, 0.577631950378418, -0.02017982490360737],
                 [0.5791119933128357, 0.6245171427726746, -0.038482457399368286],
                 [0.5733703374862671, 0.625767707824707, -0.027141081169247627],
                 [0.5834893584251404, 0.6172351241111755, -0.04627802222967148],
                 [0.5780450105667114, 0.5064063668251038, -0.009653204120695591],
                 [0.561209499835968, 0.4954060912132263, -0.012299524620175362],
                 [0.5465774536132812, 0.4919363558292389, -0.0117389727383852],
                 [0.5346513390541077, 0.4932662546634674, -0.007684758864343166],
                 [0.526763379573822, 0.4983026683330536, -0.001395673374645412],
                 [0.5218079090118408, 0.5200343728065491, 0.015773635357618332],
                 [0.49358931183815, 0.5457547903060913, 0.06246880814433098],
                 [0.5288704633712769, 0.5436587333679199, 0.009731420315802097],
                 [0.5387694835662842, 0.5504574775695801, 0.003982516936957836],
                 [0.5524967908859253, 0.551861584186554, 0.00016824668273329735],
                 [0.5655474066734314, 0.5494129657745361, -0.0014250044478103518],
                 [0.5753511786460876, 0.5454491972923279, -0.0022747928742319345],
                 [0.5819439888000488, 0.5424878597259521, -0.0029966644942760468],
                 [0.493066668510437, 0.5381511449813843, 0.09938693791627884],
                 [0.5736985206604004, 0.6286004185676575, -0.021965764462947845],
                 [0.5871212482452393, 0.5858468413352966, -0.034441277384757996],
                 [0.585274875164032, 0.6277860403060913, -0.04609551280736923],
                 [0.5894430875778198, 0.6341612935066223, -0.04153289273381233],
                 [0.5850946307182312, 0.6288809180259705, -0.041115738451480865],
                 [0.5759425759315491, 0.6325057148933411, -0.018328703939914703],
                 [0.5911786556243896, 0.6363288164138794, -0.043957602232694626],
                 [0.5918948650360107, 0.6380921006202698, -0.03178191930055618],
                 [0.5826902985572815, 0.5301530957221985, 0.0008978588157333434],
                 [0.5871235132217407, 0.535723090171814, -0.004741867538541555],
                 [0.5894140601158142, 0.5404719114303589, -0.01162816770374775],
                 [0.533679187297821, 0.5164637565612793, 0.005755421705543995],
                 [0.5282934308052063, 0.5095203518867493, 0.005690241698175669],
                 [0.6112098097801208, 0.582797110080719, -0.04161110892891884],
                 [0.6744425892829895, 0.5345631837844849, 0.009118725545704365],
                 [0.6094945073127747, 0.6380163431167603, -0.03191228210926056],
                 [0.7103713750839233, 0.47223013639450073, 0.05076242610812187],
                 [0.6428885459899902, 0.5456331968307495, -0.0008135316893458366],
                 [0.6529512405395508, 0.5485426187515259, 1.2081272871000692e-05],
                 [0.6631954312324524, 0.5488215088844299, 0.0027880878187716007],
                 [0.6766675114631653, 0.5387454032897949, 0.010846003890037537],
                 [0.6343944072723389, 0.5412406325340271, -0.00024177823797799647],
                 [0.6635878086090088, 0.5067040324211121, -0.005836896598339081],
                 [0.6515960693359375, 0.5074674487113953, -0.006286641117185354],
                 [0.673423707485199, 0.509864866733551, -0.0024328550789505243],
                 [0.6793394684791565, 0.5151978135108948, 0.0017908290028572083],
                 [0.6828911304473877, 0.548723578453064, 0.016138644888997078],
                 [0.6286532282829285, 0.742847740650177, 0.01387037057429552],
                 [0.6783842444419861, 0.5290427803993225, 0.011947550810873508],
                 [0.7091978192329407, 0.5347761511802673, 0.05954873189330101],
                 [0.6945704221725464, 0.5373106598854065, 0.02530299499630928],
                 [0.6474612951278687, 0.6129328608512878, -0.005299159325659275],
                 [0.6065141558647156, 0.6812127232551575, -0.021913619711995125],
                 [0.6044297814369202, 0.6901721358299255, -0.01595614105463028],
                 [0.6158964037895203, 0.6848764419555664, -0.01583881489932537],
                 [0.6225785613059998, 0.688209056854248, -0.00855165719985962],
                 [0.6123223900794983, 0.6911399960517883, -0.012234345078468323],
                 [0.6191955804824829, 0.6917035579681396, -0.005683722905814648],
                 [0.6376162171363831, 0.7040151953697205, 0.008740679360926151],
                 [0.6081385612487793, 0.6333822011947632, -0.05055385082960129],
                 [0.6103017926216125, 0.6202438473701477, -0.05449074134230614],
                 [0.6935206651687622, 0.5039520859718323, 0.0027424616273492575],
                 [0.6304784417152405, 0.5737110376358032, -0.010005177929997444],
                 [0.6295772790908813, 0.6262377500534058, -0.02569407969713211],
                 [0.6299809217453003, 0.6173514723777771, -0.023204190656542778],
                 [0.6751094460487366, 0.6099007725715637, 0.006804824341088533],
                 [0.6108465790748596, 0.6002051830291748, -0.04979775846004486],
                 [0.6732211709022522, 0.49154967069625854, -0.01590399630367756],
                 [0.6861438751220703, 0.4955078661441803, -0.007769492454826832],
                 [0.7038972973823547, 0.4507024586200714, 0.029200779274106026],
                 [0.6287777423858643, 0.5042503476142883, -0.023725630715489388],
                 [0.6407812237739563, 0.5124241709709167, -0.00323294335976243],
                 [0.6453682780265808, 0.6918414235115051, 0.01025286316871643],
                 [0.6919201016426086, 0.6637616753578186, 0.09714473783969879],
                 [0.6219614148139954, 0.6334018707275391, -0.021340033039450645],
                 [0.6145747900009155, 0.6372431516647339, -0.022252557799220085],
                 [0.6319965720176697, 0.6943902969360352, 0.008492994122207165],
                 [0.6297309994697571, 0.6938332319259644, 0.005380634684115648],
                 [0.6911933422088623, 0.48607438802719116, -0.0036468382459133863],
                 [0.6292524933815002, 0.6309450268745422, -0.019814815372228622],
                 [0.6546474099159241, 0.4936002492904663, -0.021326998248696327],
                 [0.6572713851928711, 0.48289188742637634, -0.024260111153125763],
                 [0.6679322719573975, 0.42248669266700745, -0.01148477103561163],
                 [0.6965844035148621, 0.4686545431613922, 0.01014205627143383],
                 [0.6610153913497925, 0.45291364192962646, -0.018784966319799423],
                 [0.6988804936408997, 0.49609243869781494, 0.010793859139084816],
                 [0.7042140960693359, 0.4855768382549286, 0.029252924025058746],
                 [0.6055280566215515, 0.6863973736763, -0.02011464349925518],
                 [0.6139864325523376, 0.6882723569869995, -0.014470028690993786],
                 [0.6209717988967896, 0.6902459263801575, -0.007965033873915672],
                 [0.6197124719619751, 0.6356392502784729, -0.019462840631604195],
                 [0.6311848759651184, 0.6940115690231323, 0.006765715777873993],
                 [0.6263862252235413, 0.6967740058898926, 0.001181393163278699],
                 [0.6284656524658203, 0.6939573287963867, 0.005064510274678469],
                 [0.6185833215713501, 0.6307536363601685, -0.03582309931516647],
                 [0.6176461577415466, 0.6929097771644592, -0.004125913605093956],
                 [0.6111692190170288, 0.6926740407943726, -0.008290935307741165],
                 [0.6034270524978638, 0.6925623416900635, -0.011706383898854256],
                 [0.6053100228309631, 0.7229514122009277, 6.024086906109005e-05],
                 [0.6041118502616882, 0.7099593281745911, -0.010174646973609924],
                 [0.6041167378425598, 0.7038165926933289, -0.011849780566990376],
                 [0.6039139628410339, 0.6976484060287476, -0.010233309119939804],
                 [0.6029734015464783, 0.6930651664733887, -0.008851486258208752],
                 [0.6176079511642456, 0.6934635639190674, -0.0024687042459845543],
                 [0.6195512413978577, 0.6956565976142883, -0.004002070985734463],
                 [0.6209644675254822, 0.6994600296020508, -0.004976516589522362],
                 [0.622604489326477, 0.7030120491981506, -0.0030308845452964306],
                 [0.6354540586471558, 0.6685655117034912, -0.0065962471999228],
                 [0.704498291015625, 0.5907464027404785, 0.10548781603574753],
                 [0.6228386759757996, 0.6935465335845947, 0.00173379632178694],
                 [0.6243856549263, 0.6954116821289062, 0.0008823784883134067],
                 [0.6110389828681946, 0.6429529190063477, -0.022083088755607605],
                 [0.6253752112388611, 0.6385675668716431, -0.012175682000815868],
                 [0.6128725409507751, 0.6406645774841309, -0.022461136803030968],
                 [0.6393377780914307, 0.5819181203842163, -0.005761939100921154],
                 [0.6544924974441528, 0.5929915308952332, -0.002255238825455308],
                 [0.6312795281410217, 0.6228163242340088, -0.01714242249727249],
                 [0.6906024217605591, 0.43392324447631836, 0.007241532672196627],
                 [0.6831198930740356, 0.4573695659637451, -0.005344785284250975],
                 [0.6773085594177246, 0.4808811843395233, -0.014939327724277973],
                 [0.6291122436523438, 0.7119081020355225, 0.004761421587318182],
                 [0.6331254839897156, 0.4867723882198334, -0.029096491634845734],
                 [0.6370009183883667, 0.4518536627292633, -0.026541423052549362],
                 [0.6422181129455566, 0.4157032370567322, -0.022369882091879845],
                 [0.6717995405197144, 0.5455483794212341, 0.007032955531030893],
                 [0.6913803815841675, 0.5592588782310486, 0.022461136803030968],
                 [0.63004469871521, 0.5374959707260132, 0.0008913407800719142],
                 [0.6871340870857239, 0.5206215381622314, 0.009822673164308071],
                 [0.6245937347412109, 0.5648913979530334, -0.014352704398334026],
                 [0.6248025894165039, 0.6225805282592773, -0.035979531705379486],
                 [0.7004092335700989, 0.5680451989173889, 0.034336987882852554],
                 [0.6844591498374939, 0.5715345144271851, 0.01424841582775116],
                 [0.6720375418663025, 0.5785281658172607, 0.005302418489009142],
                 [0.6538554430007935, 0.5749022960662842, 0.0005365154356695712],
                 [0.6403407454490662, 0.5673809051513672, -0.0020711044780910015],
                 [0.6311877369880676, 0.5603944063186646, -0.005380634684115648],
                 [0.6140037775039673, 0.5483740568161011, -0.02661963924765587],
                 [0.6961351633071899, 0.5996339917182922, 0.033763401210308075],
                 [0.6946137547492981, 0.5184670686721802, 0.01424841582775116],
                 [0.6046218872070312, 0.6388150453567505, -0.0452612079679966],
                 [0.6284822225570679, 0.5905000567436218, -0.012677569873631],
                 [0.7109789848327637, 0.527175784111023, 0.09239960461854935],
                 [0.624546229839325, 0.5534366369247437, -0.007723867427557707],
                 [0.6317331194877625, 0.6223134994506836, -0.007267604116350412],
                 [0.6810938715934753, 0.5292354822158813, 0.0138182258233428],
                 [0.6253399848937988, 0.6117560267448425, -0.03290301933884621],
                 [0.6997681856155396, 0.6259093880653381, 0.10402777791023254],
                 [0.6306154131889343, 0.5322603583335876, 0.0031319137196987867],
                 [0.618708074092865, 0.6046597957611084, -0.043331872671842575],
                 [0.6724143028259277, 0.7096786499023438, 0.04713840037584305],
                 [0.6712347269058228, 0.7207037210464478, 0.06617105007171631],
                 [0.7041257619857788, 0.5961459875106812, 0.06971686333417892],
                 [0.6835733652114868, 0.6875907182693481, 0.057984404265880585],
                 [0.7073028683662415, 0.5075968503952026, 0.04706018418073654],
                 [0.6309090256690979, 0.7556902766227722, 0.02109234780073166],
                 [0.6034496426582336, 0.6406260132789612, -0.03149512782692909],
                 [0.6361406445503235, 0.6009334325790405, -0.008062804117798805],
                 [0.7016417384147644, 0.5380381941795349, 0.035588450729846954],
                 [0.6631454229354858, 0.5404381155967712, 0.0034089302644133568],
                 [0.6539206504821777, 0.5405634641647339, 0.0009084505145438015],
                 [0.6281408667564392, 0.6986646056175232, 0.003073251573368907],
                 [0.6923075914382935, 0.6277869343757629, 0.039473194628953934],
                 [0.6115208864212036, 0.7725804448127747, 0.02530299499630928],
                 [0.6432039737701416, 0.7535678148269653, 0.04288864508271217],
                 [0.6564517617225647, 0.7406718134880066, 0.053030695766210556],
                 [0.6448773741722107, 0.5380582809448242, 0.00022955691383685917],
                 [0.6371375918388367, 0.534875214099884, 0.0012889406643807888],
                 [0.6324464678764343, 0.533043384552002, 0.0030422909185290337],
                 [0.7012172937393188, 0.5138316750526428, 0.024064570665359497],
                 [0.6411796808242798, 0.5218276381492615, -0.0006118801538832486],
                 [0.6508892178535461, 0.5177127122879028, -0.002351379720494151],
                 [0.660538911819458, 0.5174998044967651, -0.0017158717382699251],
                 [0.668940007686615, 0.5202054977416992, 0.0009149686084128916],
                 [0.6741204857826233, 0.524052083492279, 0.004279087297618389],
                 [0.7124764919281006, 0.49636349081993103, 0.07367982715368271],
                 [0.6695865988731384, 0.538156270980835, 0.0065506212413311005],
                 [0.6271891593933105, 0.6608501672744751, -0.012143092229962349],
                 [0.6222646236419678, 0.6320428252220154, -0.025654969736933708],
                 [0.6107068657875061, 0.6568742990493774, -0.021053239703178406],
                 [0.6589921712875366, 0.7281382083892822, 0.039290692657232285],
                 [0.6458756923675537, 0.7421672940254211, 0.030895469710230827],
                 [0.6122443675994873, 0.7651296257972717, 0.012377739883959293],
                 [0.6823388934135437, 0.6963751316070557, 0.08275292068719864],
                 [0.6342633962631226, 0.5279605388641357, 0.0014339666813611984],
                 [0.6185726523399353, 0.5732284188270569, -0.02768859639763832],
                 [0.6285978555679321, 0.7649011015892029, 0.032277289777994156],
                 [0.6992190480232239, 0.6277967691421509, 0.07086403667926788],
                 [0.6111310124397278, 0.6932278275489807, -0.006032437551766634],
                 [0.6123365759849548, 0.6970058083534241, -0.0076391324400901794],
                 [0.6136543154716492, 0.7021937370300293, -0.008923185057938099],
                 [0.6143488883972168, 0.7073053121566772, -0.007267604116350412],
                 [0.6185504198074341, 0.7192694544792175, 0.0010054062586277723],
                 [0.6245575547218323, 0.6929196119308472, 4.766310303239152e-05],
                 [0.6262956261634827, 0.6920157670974731, -9.374762157676741e-05],
                 [0.627787709236145, 0.6916402578353882, -0.0002409634762443602],
                 [0.6416012644767761, 0.6796513199806213, 0.0012579800095409155],
                 [0.6795898675918579, 0.6390725374221802, 0.020101608708500862],
                 [0.6193608641624451, 0.555732786655426, -0.01977570727467537],
                 [0.6251461505889893, 0.523491621017456, -0.004898300394415855],
                 [0.6307826638221741, 0.5237639546394348, -0.001002962002530694],
                 [0.6226309537887573, 0.6935210824012756, 0.0010119243524968624],
                 [0.6800547242164612, 0.6718009114265442, 0.037804581224918365],
                 [0.6178550720214844, 0.5259484052658081, -0.017846370115876198],
                 [0.6242631077766418, 0.7305812239646912, 0.007997624576091766],
                 [0.612752377986908, 0.5665109753608704, -0.03527558594942093],
                 [0.6232466101646423, 0.5965598225593567, -0.025394249707460403],
                 [0.6081315875053406, 0.7367010712623596, 0.00382608431391418],
                 [0.6480370163917542, 0.7078062891960144, 0.015565057285130024],
                 [0.6393724679946899, 0.633023738861084, -0.004344267770648003],
                 [0.6373007297515869, 0.7207310795783997, 0.012182200327515602],
                 [0.6609208583831787, 0.6303606033325195, -2.346236396988388e-05],
                 [0.6473483443260193, 0.6479639410972595, -0.0019228191813454032],
                 [0.6673424243927002, 0.6526497602462769, 0.009724901989102364],
                 [0.6112347841262817, 0.7524399161338806, 0.006074804812669754],
                 [0.6275652050971985, 0.6037912368774414, -0.01744225062429905],
                 [0.6562827825546265, 0.7157984972000122, 0.026293737813830376],
                 [0.6431471705436707, 0.7301045060157776, 0.021561646834015846],
                 [0.6560947299003601, 0.6912021040916443, 0.015486842021346092],
                 [0.6887761950492859, 0.6516479849815369, 0.04518299177289009],
                 [0.6687095761299133, 0.6905151009559631, 0.02564193494617939],
                 [0.6931520700454712, 0.658048689365387, 0.06914327293634415],
                 [0.6527338027954102, 0.6670543551445007, 0.0042334613390266895],
                 [0.6234570145606995, 0.5813668966293335, -0.019671417772769928],
                 [0.6212285757064819, 0.6288440823554993, -0.03798708692193031],
                 [0.6263064742088318, 0.631142258644104, -0.0266066025942564],
                 [0.6182326078414917, 0.6206579208374023, -0.04575657844543457],
                 [0.6348152160644531, 0.5108548402786255, -0.008792824111878872],
                 [0.6525534987449646, 0.5026980638504028, -0.011061098426580429],
                 [0.667264461517334, 0.5019888877868652, -0.01025938056409359],
                 [0.6785733699798584, 0.5050511360168457, -0.005846674088388681],
                 [0.685093104839325, 0.510737419128418, 0.0006216572364792228],
                 [0.6864629983901978, 0.533384382724762, 0.017859404906630516],
                 [0.7074925899505615, 0.565562903881073, 0.06512816995382309],
                 [0.6773523092269897, 0.5561423897743225, 0.011491288430988789],
                 [0.6669433116912842, 0.5612885355949402, 0.005517513491213322],
                 [0.6536122560501099, 0.560212254524231, 0.0014298930764198303],
                 [0.6411813497543335, 0.5551972985267639, -0.0004831490514334291],
                 [0.6325463652610779, 0.5498101711273193, -0.001548032509163022],
                 [0.626336932182312, 0.545697808265686, -0.002467074664309621],
                 [0.7078102827072144, 0.5579227209091187, 0.10220273584127426],
                 [0.6255114078521729, 0.633557915687561, -0.021496467292308807],
                 [0.6179468035697937, 0.5883703827857971, -0.03402412310242653],
                 [0.6152410507202148, 0.6306230425834656, -0.04583479464054108],
                 [0.6100245118141174, 0.6364059448242188, -0.04129824414849281],
                 [0.6149187088012695, 0.632258951663971, -0.040828946977853775],
                 [0.6229401230812073, 0.637431263923645, -0.017872441560029984],
                 [0.6080405712127686, 0.6378380656242371, -0.04387938603758812],
                 [0.6068492531776428, 0.6399259567260742, -0.03167762979865074],
                 [0.6271966695785522, 0.5332373380661011, 0.0015260340878739953],
                 [0.6222451329231262, 0.5382149815559387, -0.004520254675298929],
                 [0.6200319528579712, 0.5429699420928955, -0.011243604123592377],
                 [0.6768563985824585, 0.5269007682800293, 0.007626096252351999],
                 [0.6824787259101868, 0.5213072299957275, 0.007736903615295887],
                 [0.5521632432937622, 0.5202662944793701, -9.573357237968594e-05],
                 [0.5627942085266113, 0.521011471748352, -8.636391430627555e-05],
                 [0.5527209639549255, 0.5076291561126709, -8.025325951166451e-05],
                 [0.5415418744087219, 0.519382655620575, -8.442887337878346e-05],
                 [0.5515769124031067, 0.5333187580108643, -8.885908755473793e-05],
                 [0.6569147109985352, 0.5275269746780396, -0.00015521061141043901],
                 [0.667970597743988, 0.5281846523284912, -0.00016162679821718484],
                 [0.6573876738548279, 0.5146002173423767, -0.00016203417908400297],
                 [0.6458874940872192, 0.526453971862793, -0.0001744591718306765],
                 [0.656026303768158, 0.5404028296470642, -0.000173135194927454]]

    batch = torch.tensor(landmarks, dtype=torch.float).unsqueeze(0)  # Add batch dimension
    model = GazeGCN()
    model.train()
    with torch.no_grad():
        output = model(batch)
    print("Output shape:", output.shape)